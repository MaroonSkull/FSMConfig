# Архитектура FSMConfig

## Обзор

FSMConfig - это C++ библиотека для декларативного определения конечных автоматов с использованием YAML конфигураций и C++ коллбэков.

## Основные компоненты

### StateMachine
Основной класс библиотеки, обеспечивающий:
- Загрузку конфигурации из YAML файлов
- Регистрацию и выполнение коллбэков
- Диспетчеризацию событий
- Управление переменными состояния
- Переходы между состояниями

### ConfigParser
Класс для парсинга YAML конфигураций:
- Загрузка YAML файлов
- Парсинг конфигураций состояний и переходов
- Валидация структуры конфигурации
- Преобразование YAML данных в MachineConfig

### CallbackRegistry
Реестр коллбэков для действий и условий:
- Регистрация коллбэков по идентификаторам
- Выполнение зарегистрированных коллбэков
- Управление жизненным циклом коллбэков

### EventDispatcher
Диспетчер событий для конечного автомата:
- Регистрация обработчиков событий
- Отправка событий в автомат
- Очередь событий для синхронной обработки

### State
Класс состояния конечного автомата:
- Хранение идентификатора и описания состояния
- Управление коллбэками on_enter и on_exit
- Отслеживание активного состояния

### VariableManager
Менеджер переменных для конечного автомата:
- Хранение переменных различных типов
- Получение и установка значений переменных
- Проверка существования переменных

## Структура проекта

```
fsmconfig/
├── include/fsmconfig/    # Публичные заголовки
├── src/fsmconfig/         # Приватные заголовки и реализации
├── tests/                  # Unit тесты
├── examples/                # Примеры использования
└── docs/                   # Документация
```

## Принципы дизайна

1. **RAII**: Все ресурсы управляются автоматически через RAII
2. **Pimpl**: Использование идиомы Pimpl для сокрытия реализации
3. **Move semantics**: Поддержка перемещения для всех классов
4. **Const correctness**: Методы с модификатором const где это возможно
5. **Type safety**: Использование сильной типизации для идентификаторов

## Поток выполнения

1. Загрузка конфигурации из YAML файла
2. Парсинг конфигурации и валидация
3. Регистрация коллбэков для действий и условий
4. Запуск конечного автомата
5. Отправка событий для переходов между состояниями
6. Выполнение коллбэков при переходах

## Зависимости

- yaml-cpp: для парсинга YAML конфигураций
- GoogleTest: для тестирования (только в тестах)
